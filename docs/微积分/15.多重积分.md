

这一章中我们将 定积分 扩展到 二重 和 三重积分上，其中被积函数有两个或三个变量

这些想法被用于计算 体积、面积、质量、区域上的质心 等问题，这些区域比我们在第 6 章和第 8 章中提到的更加一般化

我们还将用 二重积分 计算两个随机变量的概率问题

###  ###

### 1.矩形区域上的二重积分 ###

!!! note "回顾 定积分"
	- 我们将区间 [a,b] 等分成 n 个区间 $[x_{i-1},x_i]$（$i=1..n$）,其中 $\Delta x=x_i-x_{i-1}=\frac {b-a}n$
	- 在每个区间 $[x_{i-1},x_i]$ 上取一个样本点，记为 $x_i^*$，每一个区间“可负面积”为 $f(x_i^*)\Delta x$
	- 因而整个区间 [a,b] 的“可负面积”为黎曼和：$\sum\limits_{i=1}^n f(x_i^*)\Delta x$
	- 令 $n\to ∞$，得到 f 从 a 到 b 的定积分：$\int_a^b f(x)~d_x = \lim\limits_{n\to ∞} \sum\limits_{i=1}^n f(x_i^*)\Delta x$
	- 注：$f(x) \ge 0$ 时，黎曼和 解释为 f 的近似矩形面积的和；积分解释为 f 之下，[a,b] 之上的图形的面积

!!! note "二重积分"
	- 定义闭矩形区域 $R=[a,b]\times[c,d] = \{(x,y)|a\le x\le b,c\le y\le d,(x,y)\in \mathbb R^2\}$ 
	- 将区间 [a,b] 分成 n 个区间 $[x_{i-1},x_i]$（$i=1..n$）,其中 $\Delta x=x_i-x_{i-1}=\frac {b-a}n$
	- 将区间 [c,d] 分成 m 个区间 $[y_{i-1},y_i]$（$i=1..m$）,其中 $\Delta y=y_i-y_{i-1}=\frac {d-c}m$
	- 每个子区域为 $R=[x_{i-1},x_i]\times[y_{j-1},y_j] = \{(x,y)|x_{i-1}\le x\le x_i,y_{j-1}\le y\le y_j,(x,y)\in \mathbb R^2\}$ ，对应的面积为 $\Delta A = \Delta A_{ij} = (x_i-x_{i-1})(y_j-y_{j-1}) = \Delta x\Delta y$
		- 在每个子区域上选取一个样本点，记为 $(x_{ij}^*, y_{ij}^*)$
		- 在每个子区域“可负体积”为 $f(x_{ij}^*, y_{ij}^*)\Delta A$
	- 因而整个区域 R 的“可负体积”为 二重黎曼和：$\sum\limits_{i=1}^n\sum\limits_{j=1}^m f(x_{ij}^*, y_{ij}^*)\Delta A$
	- 令 $n\to ∞, m\to ∞$，得到 f 在矩形区域 R 上的 二重积分：$\iint\limits_R f(x,y)~d_A = \lim\limits_{n,m\to ∞}\sum\limits_{i=1}^n\sum\limits_{j=1}^m f(x_{ij}^*, y_{ij}^*)\Delta A$
	- 注：$f(x,y) \ge 0$ 时，二重黎曼和 解释为 f 的近似立体体积的和；二重积分解释为 f 之下，区域 R 之上的立体的体积

!!! note "二重积分 定义"
> 在矩形区域 R 上的 f 的二重积分为： $\iint\limits_R f(x,y)~d_A = \lim\limits_{n,m\to ∞}\sum\limits_{i=1}^n\sum\limits_{j=1}^m f(x_{ij}^*, y_{ij}^*)\Delta A$
> 
> 如果上面的极限存在
> 
> 精确定义：对于任意的 $\epsilon > 0$，总存在正整数 N，对于所有 $n,m > N$，使得 $R_{ij}$ 中任取样本点 $(x_{ij}^*,y_{ij}^*)$ 都有 $|\iint\limits_R f(x,y)~d_A - \lim\limits_{n,m\to ∞}\sum\limits_{i=1}^n\sum\limits_{j=1}^m f(x_{ij}^*, y_{ij}^*)\Delta A| < \epsilon$
> 
> 可以证明如果 f 是连续函数，上述定义的极限存在；而有些具有较好的性质但不连续的函数，上述定义的极限也是可能存在的

!!! note
	- 如果 $f(x,y)\ge 0$，那么以矩形 R 为底，z=f(x,y) 形成的曲面为定的立体的体积 V 可以表示为： $V = \iint f(x,y)~d_A$

!!! 二重样本点的选择
> - 选择右上角 $(x_{ij}^*,y_{ij}^*) = (x_i,y_j)$
> - 中点法则：$(x_{ij}^*,y_{ij}^*) = (\overline x_i, \overline y_j) = (\frac {x_i+x_{i-1}}2, \frac {y_j+y_{j-1}}2)$
> - 梯形法则：
> - 辛普森法则：

!!! 函数平均值
> 矩形区域 R 上的二元函数的平均值为：
> 
> $f_{avg} = \frac 1{A(R)}\iint\limits_R f(x,y)~d_A$
> 
> A(R) 表示 R 的面积
> 
> 注：$A(R)\cdot f_{avg} = \iint\limits_R f(x,y)~d_A$ 表示以 R 为底 $f_{avg}$ 为高的盒子 和 f 图像下的立体有着相同的体积

!!! 二重积分的性质
> 1. $\iint\limits_R [f(x,y) + g(x,y)]~d_A = \iint\limits_R f(x,y)~d_A + \iint\limits_R g(x,y)~d_A$
> 
> 2. $\iint\limits_R cf(x,y)~d_A = c\iint\limits_R f(x,y)~d_A$ （c 为常数）
> 
> 3. $f(x,y) \ge g(x,y)$ 对于 R 中所有 (x,y) 都成立 $\implies$ $\iint\limits_R f(x,y)~d_A \ge \iint\limits_R g(x,y)~d_A$


### 2.累次积分 ###

本节我们将看到 二重积分 可以表示成 累次积分 的形式，即二重积分通过两次一重积分得到

!!! note "部分积分 & 累次积分"
> 设二元函数 f 在矩形 $R=[a,b]\times[c,d]$ 上连续，我们用记号 $\int_c^d f(x,y)~d_y$ 表示 x 固定 y 从 y=c 到 y=d 的积分，该过程称做对变量 y 的 **部分积分**
> 
> 因而，会得到依赖于 x 的函数 $A(x) = \int_c^d f(x,y)~d_y$
> 
> 然后，$\int_a^b A(x)~d_x = \int_a^b[\int_c^d f(x,y)~d_y]~d_x$，称之为 **累次积分**
> 
> 性质：$\int_a^b[\int_c^d f(x,y)~d_y]~d_x = \int_a^b\int_c^d f(x,y)~d_y~d_x$，$\int_c^d[\int_a^b f(x,y)~d_x]~d_y = \int_c^d\int_a^b f(x,y)~d_x~d_y$

!!! note "Fubini 傅比尼定理"
> 如果 f 是定义子在 $R = \{(x,y)|a\le x\le b, c\le y\le d\}$ 上的连续函数，则：
> 
> $\iint\limits_R f(x,y)~d_A = \int_a^b\int_c^d f(x,y)~d_y~d_x = \int_c^d\int_a^b f(x,y)~d_x~d_y$
> 
> 更一般地：当 f 时 R 上的旨在优先多条光滑曲线上不连续的有界函数，且对 f 的累次积分存在时，上述定理任然成立
> 
> 证明：过于困难

!!! tip
	- 累计积分的顺序（即先对什么变量进行积分）可以简化计算

!!! note "累次积分的 性质"
> $\int\limits_R f(x)g(y)~d_A = \int_a^b f(x)~d_x\int_c^d g(y)~d_y$，当 $R=[a,b]\times[c,d]$
> 
> 注：但是遇到 x 和 y 耦合的情况如何解决？

### 3.一般区域上的二重积分 ###

我们考虑在更一般的区域 D 上的积分，其中 D 可能不是一个矩形

!!! note "第 I 类平面区域 D 上的二重积分"
> f 是在第 I 类平面区域 D 上的连续函数，其中： $D = \{(x,y)|a\le x\le b, g_1(x)\le y\le g_2(x)\}$
> 
> 于是 $\iint\limits_D f(x,y)~d_A = \int_a^b\int_{g_1(x)}^{g_2(x)} f(x,y)~d_y~d_x$

!!! note "第 II 类"
> f 是在第 II 类平面区域 D 上的连续函数，其中： $D = \{(x,y)|c\le y\le d, h_1(y)\le x\le h_2(y)\}$
> 
> 于是 $\iint\limits_D f(x,y)~d_A = \int_c^d\int_{h_1(y)}^{h_2(y)} f(x,y)~d_x~d_y$

!!! note
	- 可以观察到，在计算最内层积分时，可以将除了该层中的积分变量以外的所有变量及其函数作为常量（即便是积分上下界也是如此）

!!! warning "注意"
	- 注意区分 直接计算积分 和 计算体积 问题（后者要对 f 取绝对值）
	- D 为两个曲线的封闭区域，但是曲线不一定是函数，此时 D 可能划分为多个第 I/II 类区域
	- 内层积分较难积分时，可以考虑区域转换

!!! note "性质"
> 1. $\iint\limits_D [f(x,y)+g(x,y)]~d_A = \iint\limits_D f(x,y)~d_A + \iint\limits_D g(x,y)~d_A$
> 2. $\iint\limits_D cf(x,y)~d_A = c\iint\limits_D f(x,y)~d_A$
> 3. 如果 $f(x,y)\ge g(x,y)$ 对所有 $(x,y)\in D$ 成立，那么 $\iint\limits_D f(x,y)~d_A \ge \iint\limits_D g(x,y)~d_A$
> 4. 若 $D_1 \cup D_2 = D, D_1 \cap D_2 = \emptyset$，那么 $\iint\limits_D f(x,y)~d_A = \iint\limits_{D_1} f(x,y)~d_A + \iint\limits_{D_2} f(x,y)~d_A$
> 5. $\iint\limits_D 1~d_A = A(D)$
> 6. 若 $m \le f(x,y) \le M$（$(x,y)\in D$），则 $mA(D) \le \iint\limits_D f(x,y)~d_A \le MA(D)$

### 4.极坐标下的二重积分 ###

定义 极矩形 为：$R = \{(r,\theta) | a\le r\le b, \alpha\le \theta\le \beta\}$

将区间 $[a,b]$ 划分为 n 个子区间 $[r_{i-1},r_i]$，$\Delta r=r_i-r_{i-1}=\frac {b-a}n$

将区间 $[\alpha,\beta]$ 划分为 m 个子区间 $[\theta_{i-1},\theta_i]$，$\Delta \theta=\theta_i-\theta_{i-1}=\frac {\alpha-\beta}m$

子极矩形：$R_{ij} = \{(r,\theta) | r_{i-1}\le r\le r_i, \theta_{j-1}\le \theta\le \theta_j\}$

$\Delta A_i = \frac 12r_i^2\Delta\theta - \frac 12r_{i-1}^2\Delta\theta = \frac 12(r_i^2 - r_{i-1}^2)\Delta\theta = \frac 12(r_i + r_{i-1})(r_i - r_{i-1})\Delta\theta = r_i^*\Delta r\Delta \theta$

得到黎曼和：$\sum\limits_{i=1}^n\sum\limits_{j=1}^m f(r_i^*\cos {\theta_j^*}, r_i^*\sin {\theta_j^*})\Delta A_i$

$\iint\limits_R f(x,y)~d_A = \lim\limits_{n,m\to ∞}\sum\limits_{i=1}^n\sum\limits_{j=1}^m f(r_i^*\cos {\theta_j^*}, r_i^*\sin {\theta_j^*})\Delta A_i = \sum\limits_{i=1}^n\sum\limits_{j=1}^m f(r_i^*\cos {\theta_j^*}, r_i^*\sin {\theta_j^*})r_i^*\Delta r\Delta \theta$

于是 $\iint\limits_R f(x,y)~d_A = \int_\alpha^\beta\int_a^bf(r\cos\theta, r\sin\theta)r~d_rd_\theta$

!!! note "二重积分(极坐标)"
> f 是定义在极矩形 R 上的连续函数，而极矩形 R 由 $0\le a\le r\le b, \alpha\le \theta\le \beta$ 给出，且满足 $0\le \beta - \alpha \le 2\pi$，则
> 
> $\iint\limits_R f(x,y)~d_A = \int_\alpha^\beta\int_a^bf(r\cos\theta, r\sin\theta)r~d_rd_\theta$

!!! note "第 I 类区域"
> $D = \{(r,\theta) | \alpha\le\theta\le\beta, h_1(\theta)\le r\le h_2(\theta)\}$
> 
> 则有 $\iint\limits_R f(x,y)~d_A = \int_\alpha^\beta\int_{h_1(\theta)}^{h_2(\theta)}f(r\cos\theta, r\sin\theta)r~d_rd_\theta$
> 
> 特别地，若 $f(x,y)=1,h_1(\theta)=0,h_2(\theta)=h(\theta)$，
> 
> 那么 $A(D) = \iint\limits_D 1~d_A = \int_\alpha^\beta \int_0^{h(\theta)}r~d_rd_\theta = \int_\alpha^\beta \frac 12[h(\theta)]^2~d_\theta$

!!! note "第 II 类区域"


### 5.二重积分的应用 ###

### 6.曲面积分 ###

### 7.三重积分 ###

### 8.柱面坐标系 & 球坐标系下的三重积分 ###

